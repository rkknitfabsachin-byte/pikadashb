<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PI Dashboard</title>

<style>
body{
  margin:0;
  font-family:Inter,system-ui;
  background:#f1f5f9;
}
.wrap{max-width:1300px;margin:auto;padding:16px;}
h1{margin-bottom:12px}

.cards{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
}
.card{
  background:white;
  padding:16px;
  border-radius:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}
.card h3{margin:0;font-size:14px;color:#64748b}
.card p{margin:6px 0 0;font-size:22px;font-weight:700}

.filters{
  margin:20px 0;
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
}
.filters input,.filters select{
  padding:10px;
  border-radius:10px;
  border:1px solid #cbd5e1;
}

table{
  width:100%;
  border-collapse:collapse;
  background:white;
  border-radius:16px;
  overflow:hidden;
}
th{
  background:#e2e8f0;
  padding:10px;
  font-size:13px;
}
td{
  padding:10px;
  font-size:13px;
  border-bottom:1px solid #e5e7eb;
  text-align:center;
}
a{color:#2563eb;text-decoration:none}

@media(max-width:900px){
  .cards{grid-template-columns:repeat(2,1fr)}
  .filters{grid-template-columns:1fr 1fr}
}
@media(max-width:500px){
  .cards,.filters{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="wrap">
<h1>Proforma Invoice Dashboard</h1>

<div class="cards">
  <div class="card"><h3>Total PIs</h3><p id="c1">0</p></div>
  <div class="card"><h3>Total Qty</h3><p id="c2">0</p></div>
  <div class="card"><h3>Total Amount</h3><p id="c3">0</p></div>
  <div class="card"><h3>Grand Total</h3><p id="c4">0</p></div>
</div>

<div class="filters">
  <input id="fParty" placeholder="Party name">
  <input type="date" id="fFrom">
  <input type="date" id="fTo">
  <select id="fPriority">
    <option value="">Priority</option>
    <option>High</option>
    <option>Medium</option>
    <option>Low</option>
  </select>
</div>

<table>
<thead>
<tr>
<th>Date</th><th>Party</th><th>Item</th><th>Qty</th>
<th>Rate</th><th>Amount</th><th>GST</th><th>Total</th><th>PDF</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwX0Nw7eLYhD1uQaNrSXr80CMnugOHU3PGccZmbtiNqC5C72hboQCbYPOg7ee1on3RX/exec";
let DATA=[];

fetch(API_URL).then(r=>r.json()).then(d=>{
  DATA=d;
  render(DATA);
});

function fmt(d){
  if(!d) return "";
  let dt=new Date(d);
  return dt.toLocaleDateString("en-GB");
}

function render(rows){
  let tb=document.getElementById("tbody");
  tb.innerHTML="";
  let tq=0,ta=0,tg=0;

  rows.forEach(r=>{
    tq+=+r.Qty||0;
    ta+=+r.Amount||0;
    tg+=+r["Grand Total"]||0;

    tb.insertAdjacentHTML("beforeend",`
      <tr>
        <td>${fmt(r.Date)}</td>
        <td>${r["Party Name"]}</td>
        <td>${r.Item}</td>
        <td>${r.Qty}</td>
        <td>${r.Rate}</td>
        <td>${r.Amount}</td>
        <td>${r.GST_5pct}</td>
        <td>${r["Grand Total"]}</td>
        <td>${r["PDF Link"] ? `<a href="${r["PDF Link"]}" target="_blank">View</a>`:""}</td>
      </tr>
    `);
  });

  c1.innerText=rows.length;
  c2.innerText=tq;
  c3.innerText=ta;
  c4.innerText=tg;
}
</script>
</body>
</html>
